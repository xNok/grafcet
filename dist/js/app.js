function edg_initBuffer(){edg_buffer.step1="",edg_buffer.step2="",edg_buffer.c="",edg_buffer.type=""}function edg_addLink(){ListOfEdges.push(edg_buffer)}function edg_addRow(t){$(t+" tbody").append("<tr><td></td><td></td><td></td><td></td></tr>")}function edg_write2lastRowCell(t,e){$("#edgeList tr:last td:eq("+t+")").text(e)}function adj_newVertice(t){step=AdjList.nbr_vertices,AdjList.adjList[step]=new Array,AdjList.adjList[step].action="",AdjList.adjList[step].nbr_adj=0,AdjList.adjList[step].adj=new Array,AdjList.nbr_vertices++,t&&AdjList.initialSteps.push(step)}function adj_setCoordinate(t,e,a){AdjList.adjList[t].data_x=e,AdjList.adjList[t].data_y=a}function adj_getX(t){return AdjList.adjList[t].data_x}function adj_getY(t){return AdjList.adjList[t].data_y}function adj_newAdj(t,e,a,d){AdjList.adjList[t].nbr_adj++,AdjList.adjList[t].adj["X"+e]=new Array,AdjList.adjList[t].adj["X"+e].type=a,AdjList.adjList[t].adj["X"+e].connection=d}function adj_setAction(t,e){AdjList.adjList[t].action=e}function adj_setConnection(t,e,a,d){AdjList.adjList[step].adj["X"+e]=new Array,AdjList.adjList[step].adj["X"+e].type=a,AdjList.adjList[step].adj["X"+e].connection=d}function adj_draw(){var t=$("#adjList ul"),e=$("#adjList span");t.text(""),e.text("Initials:");for(var a in AdjList.initialSteps)e.append(a+",");$.each(AdjList.adjList,function(e,a){var d=$("<li/>").addClass("vertices").attr("data_step",e).text(e+" -> "+a.action+" @("+a.data_x+","+a.data_y+")").appendTo(t),i=$("<ul/>").addClass("adj").attr("data_step",e).appendTo(d);for(var e in a.adj)var s=$("<li/>").addClass("adj").text(e+" -> "+a.adj[e].type+", "+a.adj[e].connection).attr("data_step",e).appendTo(i)})}function svg_get(t){return'<svg><use xlink:href="sprite.svg#'+t+'"></use></svg>'}$(document).foundation();var prog_step=0,step=0,ListOfEdges=new Array,edg_buffer=new Array,AdjList=new Array,adj_waiting_step=0;AdjList.nbr_vertices=0,AdjList.adjList=new Array,AdjList.initialSteps=new Array,adj_newVertice(),adj_newVertice(),adj_newVertice(),adj_newVertice(),adj_newVertice(),adj_newAdj(0,1,"join","i0"),adj_newAdj(1,2,"join","i1"),adj_newAdj(1,3,"join","i2"),adj_newAdj(3,4,"join","i3"),adj_newAdj(1,4,"join","i1"),adj_setAction(0,"KM42"),adj_setAction(1,"KM2"),adj_setAction(2,"KM1"),adj_setAction(3,"KM2"),$(document).ready(function(){adj_draw(),$("#grafcet-schema").createGrid();var t=$(".item").first();$(document).on("click",".item",function(e){t.toggleClass("active_item"),$(this).toggleClass("active_item"),t=$(this)}),$(document).on("click",".g_step",function(e){var a=$(this);if(t.hasClass("step")&&(a.children("div.content").text(t.text()+step),a.attr("data-step",step),"Initial_Step"===t.attr("data-type")?(adj_newVertice(!0),a.append(svg_get("initStep"))):(adj_newVertice(),a.append(svg_get("step"))),adj_setCoordinate(step,a.attr("data-x"),a.attr("data-y")),adj_draw(),step++),t.hasClass("connection")){var d=a.attr("data-step");if("undefined"==typeof d)return;if(0===prog_step)edg_write2lastRowCell(0,d),adj_waiting_step=d,prog_step=1;else if(1===prog_step){var i=t.text();edg_write2lastRowCell(1,d),edg_write2lastRowCell(2,i),edg_addRow("#edgeList"),adj_newAdj(adj_waiting_step,d,i,""),adj_draw();var s=adj_getX(adj_waiting_step)-adj_getX(d),n=adj_getY(adj_waiting_step)-adj_getY(d);if(-2===s&&0===n){var j=Number(adj_getX(d))-1,r=adj_getY(d);$(".g_trans[data-x='"+j+"'][data-y='"+r+"']").append(svg_get("join"))}prog_step=0}}})});