$(document).foundation();var prog_step=0,step=0,transition=0,adj_waiting_step=0,AdjList=new AdjList,ListOfEdges=new Array;AdjList.newInitialVertice(),AdjList.setCoordinate(0,0,4),AdjList.newVertice(),AdjList.setCoordinate(1,2,3),AdjList.newVertice(),AdjList.setCoordinate(2,2,5),AdjList.newVertice(),AdjList.setCoordinate(3,4,4),AdjList.newVertice(),AdjList.setCoordinate(4,6,3),AdjList.newVertice(),AdjList.setCoordinate(5,6,5),AdjList.newVertice(),AdjList.setCoordinate(6,8,4),AdjList.newAdj(0,1,"join","i1"),AdjList.newAdj(0,2,"join","i2"),AdjList.newAdj(1,3,"join","i2"),AdjList.newAdj(2,3,"join","i1"),AdjList.newAdj(3,4,"join","i3"),AdjList.newAdj(3,5,"join","i3"),AdjList.newAdj(4,6,"join","i4"),AdjList.newAdj(5,6,"join","i5"),AdjList.newAdj(6,0,"join","i2"),AdjList.setAction(0,"L_R1"),AdjList.setAction(1,"L_G1"),AdjList.setAction(2,"L_Y1"),AdjList.setAction(3,"L_R1"),AdjList.setAction(4,"L_G2"),AdjList.setAction(5,"L_Y2"),AdjList.setAction(6,"L_R2"),console.log(AdjList);var Edges=adj2edj(AdjList);$("#edgeList").edg_draw(Edges),$(document).ready(function(){function t(t){var e="";for(i in t.adjList){e+="if(Etapes["+i+"]){ \n    //UP \n";for(j in t.adjList[i].adj)e+="    if("+t.adjList[i].adj[j].connection+"){ \n        Etapes["+j.substr(1)+"] = unactivate = true; \n        digitalWrite("+t.adjList[j.substr(1)].action+", HIGH); \n    } \n";e+="    //Down \n    if(unactivate){ \n        Etapes["+i+"] = unactivate = false; \n        digitalWrite("+i.action+", LOW); \n    } \n}"}$("#Steps").text(e)}$("#adjList").adj_draw(),$("#grafcet-schema").createGrid(),$("#grafcet-schema").loadGrid(AdjList),t(AdjList);var e=$(".item").first();$(document).on("click",".item",function(t){e.toggleClass("active_item"),$(this).toggleClass("active_item"),e=$(this)}),$(document).on("click",".g_step",function(i){var d=$(this);if(e.hasClass("step")&&(d.drawStepOnGrid(step),d.attr("data-step",step),"Initial_Step"===e.attr("data-type")?(AdjList.newInitialVertice(),d.append(svg_get("initStep"))):(AdjList.newVertice(),d.append(svg_get("step"))),adj_setCoordinate(step,d.attr("data-x"),d.attr("data-y")),$("#adjList").adj_draw(),step++),e.hasClass("connection")){var s=d.attr("data-step");if("undefined"==typeof s)return;if(0===prog_step)$("#edgeList").edg_write2lastRowCell(0,s),adj_waiting_step=s,prog_step=1;else if(1===prog_step){var a=e.text();$("#edgeList").edg_write2lastRowCell(1,s),$("#edgeList").edg_write2lastRowCell(2,a),$("#edgeList").edg_addRow(),adj_newAdj(adj_waiting_step,s,a,""),$("#adjList").adj_draw();var n=adj_getX(adj_waiting_step)-adj_getX(s),j=adj_getY(adj_waiting_step)-adj_getY(s);if(-2===n&&0===j){var o=Number(adj_getX(s))-1,r=adj_getY(s);$(".g_trans[data-x='"+o+"'][data-y='"+r+"']").append(svg_get("join"))}prog_step=0}}t(AdjList)})});